<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Carl de Boer" />


<title>Re-analysis of CD69 CRISPRa tiling screen</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>
<style type="text/css">
a.anchor-section {margin-left: 10px; visibility: hidden; color: inherit;}
a.anchor-section::before {content: '#';}
.hasAnchor:hover a.anchor-section {visibility: visible;}
</style>
<script>// Anchor sections v1.0 written by Atsushi Yasumoto on Oct 3rd, 2020.
document.addEventListener('DOMContentLoaded', function() {
  // Do nothing if AnchorJS is used
  if (typeof window.anchors === 'object' && anchors.hasOwnProperty('hasAnchorJSLink')) {
    return;
  }

  const h = document.querySelectorAll('h1, h2, h3, h4, h5, h6');

  // Do nothing if sections are already anchored
  if (Array.from(h).some(x => x.classList.contains('hasAnchor'))) {
    return null;
  }

  // Use section id when pandoc runs with --section-divs
  const section_id = function(x) {
    return ((x.classList.contains('section') || (x.tagName === 'SECTION'))
            ? x.id : '');
  };

  // Add anchors
  h.forEach(function(x) {
    const id = x.id || section_id(x.parentElement);
    if (id === '') {
      return null;
    }
    let anchor = document.createElement('a');
    anchor.href = '#' + id;
    anchor.classList = ['anchor-section'];
    x.classList.add('hasAnchor');
    x.appendChild(anchor);
  });
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Re-analysis of CD69 CRISPRa tiling screen</h1>
<h4 class="author">Carl de Boer</h4>
<h4 class="date">5/21/2020</h4>



<div id="tutorial-re-analysis-of-cd69-crispra-tiling-screen" class="section level1">
<h1>Tutorial: Re-analysis of CD69 CRISPRa tiling screen</h1>
<p>See Simeonov et al. Discovery of stimulation-responsive immune enhancers with CRISPR activation. Nature. 2017 Sep 7;549(7670):111-115. doi: 10.1038/nature23875. Epub 2017 Aug 30. <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5675716/">PMC5675716</a> for the original publication associated with this dataset.</p>
<p>This tutorial is designed to get you quickly up and running with MAUDE. The only requirements are that you have R and the following R libraries installed: <code>ggplot2, openxlsx, MAUDE, reshape</code></p>
<div id="load-required-libraries-into-r" class="section level2">
<h2>Load required libraries into R</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co">#load required libraries</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(openxlsx)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">library</span>(reshape)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">library</span>(MAUDE)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="kw">library</span>(GenomicRanges)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="kw">library</span>(ggbio)</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="kw">library</span>(Homo.sapiens)</span></code></pre></div>
</div>
<div id="load-cd69-screen-count-data-from-simeonov-supplementary-table-1" class="section level2">
<h2>Load CD69 screen count data from Simeonov Supplementary Table 1</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co">#read in the CD69 screen data</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>CD69Data =<span class="st"> </span><span class="kw">read.xlsx</span>(<span class="st">&#39;https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5675716/bin/NIHMS913084-supplement-supplementary_table_1.xlsx&#39;</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co">#identify non-targeting guides</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>CD69Data<span class="op">$</span>isNontargeting =<span class="st"> </span><span class="kw">grepl</span>(<span class="st">&quot;negative_control&quot;</span>, CD69Data<span class="op">$</span>gRNA_systematic_name)</span>
<span id="cb2-6"><a href="#cb2-6"></a></span>
<span id="cb2-7"><a href="#cb2-7"></a>CD69Data =<span class="st"> </span><span class="kw">unique</span>(CD69Data) <span class="co"># for some reason there were duplicated rows in this table - remove duplicates</span></span>
<span id="cb2-8"><a href="#cb2-8"></a></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co">#reshape the count data so we can label the experimental replicates and bins, and remove all the non-count data</span></span>
<span id="cb2-10"><a href="#cb2-10"></a>cd69CountData =<span class="st"> </span><span class="kw">melt</span>(CD69Data, <span class="dt">id.vars =</span> <span class="kw">c</span>(<span class="st">&quot;PAM_3primeEnd_coord&quot;</span>,<span class="st">&quot;isNontargeting&quot;</span>,<span class="st">&quot;gRNA_systematic_name&quot;</span>))</span>
<span id="cb2-11"><a href="#cb2-11"></a>cd69CountData =<span class="st"> </span>cd69CountData[<span class="kw">grepl</span>(<span class="st">&quot;.count$&quot;</span>,cd69CountData<span class="op">$</span>variable),] <span class="co"># keep only read count columns</span></span>
<span id="cb2-12"><a href="#cb2-12"></a>cd69CountData<span class="op">$</span>Bin =<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;CD69(.*)([12]).count&quot;</span>,<span class="st">&quot;</span><span class="ch">\\</span><span class="st">1&quot;</span>,cd69CountData<span class="op">$</span>variable)</span>
<span id="cb2-13"><a href="#cb2-13"></a>cd69CountData<span class="op">$</span>expt =<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;CD69(.*)([12]).count&quot;</span>,<span class="st">&quot;</span><span class="ch">\\</span><span class="st">2&quot;</span>,cd69CountData<span class="op">$</span>variable)</span>
<span id="cb2-14"><a href="#cb2-14"></a>cd69CountData<span class="op">$</span>reads=<span class="st"> </span><span class="kw">as.numeric</span>(cd69CountData<span class="op">$</span>value); cd69CountData<span class="op">$</span>value=<span class="ot">NULL</span>;</span>
<span id="cb2-15"><a href="#cb2-15"></a>cd69CountData<span class="op">$</span>Bin =<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;_&quot;</span>,<span class="st">&quot;&quot;</span>,cd69CountData<span class="op">$</span>Bin) <span class="co"># remove extra underscores</span></span>
<span id="cb2-16"><a href="#cb2-16"></a></span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="co">#reshape into a matrix</span></span>
<span id="cb2-18"><a href="#cb2-18"></a>binReadMat =<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">cast</span>(cd69CountData[<span class="op">!</span><span class="kw">is.na</span>(cd69CountData<span class="op">$</span>PAM_3primeEnd_coord) <span class="op">|</span><span class="st"> </span>cd69CountData<span class="op">$</span>isNontargeting,], </span>
<span id="cb2-19"><a href="#cb2-19"></a>  PAM_3primeEnd_coord<span class="op">+</span>gRNA_systematic_name<span class="op">+</span>isNontargeting<span class="op">+</span>expt <span class="op">~</span><span class="st"> </span>Bin, <span class="dt">value=</span><span class="st">&quot;reads&quot;</span>))</span>
<span id="cb2-20"><a href="#cb2-20"></a><span class="co">#binReadMat now contains a matrix in the proper format for MAUDE analysis</span></span></code></pre></div>
<p>##read in the Encode DHS peaks at the locus We can use this as a reference point with which to view our results, and to annotate guides with regulatory elements. These are all the DHS peaks at CD69 in Jurkat cells, merged across two replicates.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>dhsPeakBED =<span class="st"> </span><span class="kw">read.table</span>(<span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;Encode_Jurkat_DHS_both.merged.bed&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;MAUDE&quot;</span>, <span class="dt">mustWork =</span> <span class="ot">TRUE</span>), </span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="dt">stringsAsFactors=</span><span class="ot">FALSE</span>, <span class="dt">row.names=</span><span class="ot">NULL</span>, <span class="dt">sep=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, <span class="dt">header=</span><span class="ot">FALSE</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="kw">names</span>(dhsPeakBED) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;chrom&quot;</span>,<span class="st">&quot;start&quot;</span>,<span class="st">&quot;end&quot;</span>);</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">#add a column to include peak names</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>dhsPeakBED<span class="op">$</span>name =<span class="st"> </span><span class="kw">paste</span>(dhsPeakBED<span class="op">$</span>chrom, <span class="kw">paste</span>(dhsPeakBED<span class="op">$</span>start, dhsPeakBED<span class="op">$</span>end, <span class="dt">sep=</span><span class="st">&quot;-&quot;</span>), <span class="dt">sep=</span><span class="st">&quot;:&quot;</span>)</span></code></pre></div>
</div>
<div id="read-in-and-inspect-bin-fractions" class="section level2">
<h2>Read in and inspect bin fractions</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co">#read in the bin fractions derived from Simeonov et al Extended Data Fig 1a and the &quot;digitize&quot; R package</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co">#Ideally, you derive this from the FACS sort data. </span></span>
<span id="cb4-3"><a href="#cb4-3"></a>binStats =<span class="st"> </span><span class="kw">read.table</span>(<span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;CD69_bin_percentiles.txt&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;MAUDE&quot;</span>, <span class="dt">mustWork =</span> <span class="ot">TRUE</span>), </span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="dt">stringsAsFactors=</span><span class="ot">FALSE</span>, <span class="dt">row.names=</span><span class="ot">NULL</span>, <span class="dt">sep=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>)</span>
<span id="cb4-5"><a href="#cb4-5"></a>binStats<span class="op">$</span>fraction =<span class="st"> </span>binStats<span class="op">$</span>binEndQ <span class="op">-</span><span class="st"> </span>binStats<span class="op">$</span>binStartQ; <span class="co">#the fraction of cells captured is the difference in bin start and end percentiles</span></span>
<span id="cb4-6"><a href="#cb4-6"></a></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co">#plot the bins as the percentiles of the distribution captured by each bin</span></span>
<span id="cb4-8"><a href="#cb4-8"></a>p =<span class="st"> </span><span class="kw">ggplot</span>(binStats, <span class="kw">aes</span>(<span class="dt">colour=</span>Bin)) <span class="op">+</span><span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x=</span>binStartQ, <span class="dt">xend=</span>binEndQ, <span class="dt">y=</span>fraction, <span class="dt">yend=</span>fraction)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Bin bounds as percentiles&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Fraction of the distribution captured&quot;</span>) <span class="op">+</span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="op">+</span><span class="kw">coord_cartesian</span>(<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.7</span>)); <span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>This shows the sizes of the bins in terms of the fractions of the overall distribution covered by each bin. In terms of expression space, we need to convert these to Z scores with the reverse normal CDF function <code>qnorm</code></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co">#convert bin fractions to Z scores</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>binStats<span class="op">$</span>binStartZ =<span class="st"> </span><span class="kw">qnorm</span>(binStats<span class="op">$</span>binStartQ)</span>
<span id="cb5-3"><a href="#cb5-3"></a>binStats<span class="op">$</span>binEndZ =<span class="st"> </span><span class="kw">qnorm</span>(binStats<span class="op">$</span>binEndQ)</span></code></pre></div>
<p>Now let’s plot the bins as the Z score bounds of a normal distribution, with an actual normal distribution overlaid in gray.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>p =<span class="st"> </span><span class="kw">ggplot</span>(binStats, <span class="kw">aes</span>(<span class="dt">colour=</span>Bin))  <span class="op">+</span><span class="st"> </span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">data=</span><span class="kw">data.frame</span>(<span class="dt">x=</span><span class="kw">rnorm</span>(<span class="dv">100000</span>)), <span class="kw">aes</span>(<span class="dt">x=</span>x), <span class="dt">fill=</span><span class="st">&quot;gray&quot;</span>, <span class="dt">colour=</span><span class="ot">NA</span>)<span class="op">+</span><span class="st"> </span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x=</span>binStartZ, <span class="dt">xend=</span>binEndZ, <span class="dt">y=</span>fraction, <span class="dt">yend=</span>fraction)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Bin bounds as expression Z-scores&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Fraction of the distribution captured&quot;</span>) <span class="op">+</span><span class="kw">theme_classic</span>()<span class="op">+</span><span class="kw">scale_y_continuous</span>(<span class="dt">expand=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="op">+</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.7</span>)); <span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Here, we are forced to use the same distribution for both experimental replicates since we didn’t have the underlying data. You should derive this data from the FACS sorting data separately for each replicate (although it doesn’t affect things that much if the bins were drawn similarly).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>binStats =<span class="st"> </span><span class="kw">rbind</span>(binStats, binStats) <span class="co">#duplicate data</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>binStats<span class="op">$</span>expt =<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;1&quot;</span>,<span class="dv">4</span>),<span class="kw">rep</span>(<span class="st">&quot;2&quot;</span>,<span class="dv">4</span>)); <span class="co">#name the first duplicate expt &quot;1&quot; and the next expt &quot;2&quot;;</span></span></code></pre></div>
</div>
<div id="maude-calculate-guide-level-statistics" class="section level2">
<h2>1) MAUDE: Calculate guide level statistics</h2>
<p>Now we’ve finally gotten to the part where we’re running MAUDE. To compute guide-level stats, we run <code>findGuideHitsAllScreens</code>.</p>
<p>This step takes about a minute to run.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>guideLevelStats =<span class="st"> </span><span class="kw">findGuideHitsAllScreens</span>(<span class="dt">experiments =</span> <span class="kw">unique</span>(binReadMat[<span class="st">&quot;expt&quot;</span>]), </span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="dt">countDataFrame =</span> binReadMat, <span class="dt">binStats =</span> binStats, </span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="dt">sortBins =</span> <span class="kw">c</span>(<span class="st">&quot;baseline&quot;</span>,<span class="st">&quot;high&quot;</span>,<span class="st">&quot;low&quot;</span>,<span class="st">&quot;medium&quot;</span>), </span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="dt">unsortedBin =</span> <span class="st">&quot;back&quot;</span>, <span class="dt">negativeControl =</span> <span class="st">&quot;isNontargeting&quot;</span>)</span></code></pre></div>
<p>Here, we calculated the mean expression of each guide</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># Plot the guide-level mus</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>p =<span class="st"> </span><span class="kw">ggplot</span>(guideLevelStats, <span class="kw">aes</span>(<span class="dt">x=</span>mean, <span class="dt">colour=</span>isNontargeting, <span class="dt">linetype=</span>expt)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>()<span class="op">+</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="st">  </span><span class="kw">theme_classic</span>()<span class="op">+</span><span class="kw">scale_y_continuous</span>(<span class="dt">expand=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>)<span class="op">+</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Learned mean guide expression&quot;</span>); <span class="kw">print</span>(p);</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>But notice how the distributions for the non-targeting guides are off-centre. This is why we also calculate a re-centred Z-score using the non-targeting guides.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># Plot the guide-level Zs</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>p =<span class="st"> </span><span class="kw">ggplot</span>(guideLevelStats, <span class="kw">aes</span>(<span class="dt">x=</span>Z, <span class="dt">colour=</span>isNontargeting, <span class="dt">linetype=</span>expt)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>()<span class="op">+</span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="st">  </span><span class="kw">theme_classic</span>()<span class="op">+</span><span class="kw">scale_y_continuous</span>(<span class="dt">expand=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>)<span class="op">+</span></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Learned guide expression Z score&quot;</span>); </span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Now the non-targeting guides are centred at 0, as expected since they have no effect on expression.</p>
<p>Now that we have guide-level statistics, we can inspect them. We can see there is a high correlation between replicates:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>guideEffectsByRep =<span class="st"> </span><span class="kw">cast</span>(guideLevelStats, </span>
<span id="cb11-2"><a href="#cb11-2"></a>  gRNA_systematic_name <span class="op">+</span><span class="st"> </span>isNontargeting <span class="op">+</span><span class="st"> </span>PAM_3primeEnd_coord <span class="op">~</span><span class="st"> </span>expt, <span class="dt">value=</span><span class="st">&quot;Z&quot;</span>)</span>
<span id="cb11-3"><a href="#cb11-3"></a></span>
<span id="cb11-4"><a href="#cb11-4"></a>p =<span class="st"> </span><span class="kw">ggplot</span>(guideEffectsByRep[<span class="op">!</span>guideEffectsByRep<span class="op">$</span>isNontargeting,], <span class="kw">aes</span>(<span class="dt">x=</span><span class="st">`</span><span class="dt">1</span><span class="st">`</span>, <span class="dt">y=</span><span class="st">`</span><span class="dt">2</span><span class="st">`</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Replicate 1 Z score&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Replicate 2 Z score&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="kw">sprintf</span>(<span class="st">&quot;r = %f&quot;</span>,<span class="kw">cor</span>(guideEffectsByRep<span class="op">$</span><span class="st">`</span><span class="dt">1</span><span class="st">`</span>[<span class="op">!</span>guideEffectsByRep<span class="op">$</span>isNontargeting],</span>
<span id="cb11-7"><a href="#cb11-7"></a>    guideEffectsByRep<span class="op">$</span><span class="st">`</span><span class="dt">2</span><span class="st">`</span>[<span class="op">!</span>guideEffectsByRep<span class="op">$</span>isNontargeting])))<span class="op">+</span><span class="kw">theme_classic</span>(); </span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>They are pretty highly correlated at the effect size. Now let’s map the results across the CD69 locus.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>dhsPos =<span class="st"> </span><span class="kw">min</span>(guideLevelStats<span class="op">$</span>Z)<span class="op">*</span><span class="fl">1.05</span>;</span>
<span id="cb12-2"><a href="#cb12-2"></a>p=<span class="kw">ggplot</span>(guideLevelStats, <span class="kw">aes</span>(<span class="dt">x=</span>PAM_3primeEnd_coord, <span class="dt">y=</span>Z)) <span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="fl">0.5</span>)<span class="op">+</span><span class="kw">facet_grid</span>(expt <span class="op">~</span>.)<span class="op">+</span><span class="st"> </span></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">geom_segment</span>(<span class="dt">data =</span> dhsPeakBED, <span class="kw">aes</span>(<span class="dt">x=</span>start, <span class="dt">xend=</span>end,<span class="dt">y=</span>dhsPos, <span class="dt">yend=</span>dhsPos), <span class="dt">colour=</span><span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Genomic position&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Guide Z score&quot;</span>); </span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="kw">print</span>(p)</span></code></pre></div>
<pre><code>## Warning: Removed 4478 rows containing missing values (geom_point).</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Here, the DHS peaks are shown in red. Clearly some regions contain many active guides, the majority of which have high Z-scores, indicating CD69 activation.</p>
</div>
<div id="maude-identify-active-elements" class="section level2">
<h2>2) MAUDE: Identify active elements</h2>
<p>There are two ways to get element-level statistics, depending on how the screen was done. If you have regulatory element annotations, you can use <code>getElementwiseStats</code> to identify active elements. If you did a tiling screen, you could use the same, but you can also identify active regions in an unbiased way with <code>getTilingElementwiseStats</code>. ### 2a) Get element level stats with sliding window Now, we can combine adjacent guides in an unbiased way, using a sliding window across the locus to identify regions with more active guides than expected by chance. Here we use a sliding window of 200 bp, and the default minimum guide number (5). Any 200 bp with fewer than 5 guides will not be tested.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>guideLevelStats<span class="op">$</span>chrom =<span class="st"> &quot;chr12&quot;</span>; <span class="co"># we need to tell it what chromosome our guides are on - they&#39;re all on chr12</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>slidingWindowElements =<span class="st"> </span><span class="kw">getTilingElementwiseStats</span>(<span class="dt">experiments =</span> <span class="kw">unique</span>(binReadMat[<span class="st">&quot;expt&quot;</span>]), </span>
<span id="cb14-3"><a href="#cb14-3"></a>  <span class="dt">normNBSummaries =</span> guideLevelStats, <span class="dt">tails=</span><span class="st">&quot;both&quot;</span>, <span class="dt">window =</span> <span class="dv">200</span>, <span class="dt">location =</span> <span class="st">&quot;PAM_3primeEnd_coord&quot;</span>,</span>
<span id="cb14-4"><a href="#cb14-4"></a>  <span class="dt">chr=</span><span class="st">&quot;chrom&quot;</span>,<span class="dt">negativeControl =</span> <span class="st">&quot;isNontargeting&quot;</span>)</span></code></pre></div>
<pre><code>## Building null model</code></pre>
<pre><code>## Building background with 4478 non-targeting guides</code></pre>
<pre><code>## Calculating P-values</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co">#override the default chromosome field &#39;chr&#39; with the GRanges compatible &#39;chrom&#39;</span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="kw">names</span>(slidingWindowElements)[<span class="kw">names</span>(slidingWindowElements)<span class="op">==</span><span class="st">&quot;chr&quot;</span>]=<span class="st">&quot;chrom&quot;</span> </span></code></pre></div>
<p>Now that we have element-level stats, let’s inspect them! First, let’s look at the whole locus.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>dhsPos =<span class="st"> </span><span class="kw">min</span>(slidingWindowElements<span class="op">$</span>meanZ)<span class="op">*</span><span class="fl">1.05</span>;</span>
<span id="cb19-2"><a href="#cb19-2"></a>p=<span class="kw">ggplot</span>(slidingWindowElements, <span class="kw">aes</span>(<span class="dt">x=</span>start, <span class="dt">xend=</span>end, <span class="dt">y=</span>meanZ,<span class="dt">yend=</span>meanZ, <span class="dt">colour=</span>FDR<span class="op">&lt;</span><span class="fl">0.01</span>)) <span class="op">+</span></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">geom_segment</span>(<span class="dt">size=</span><span class="dv">1</span>)<span class="op">+</span><span class="kw">facet_grid</span>(expt <span class="op">~</span>.) <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Genomic position&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Element Z score&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">geom_segment</span>(<span class="dt">data =</span> dhsPeakBED, <span class="kw">aes</span>(<span class="dt">x=</span>start, <span class="dt">xend=</span>end,<span class="dt">y=</span>dhsPos, <span class="dt">yend=</span>dhsPos), <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>);</span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>In the above, we see that there are some regions significantly upregulated or down-regulated, which are often shared between the two replicates. The regions that upregulate CD69 preferentially lie in open chromatin (DHS - black, in the above).</p>
<p>How correlated are the effect size estimates for the two replicates at the element level?</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>slidingWindowElementsByRep =<span class="st"> </span><span class="kw">cast</span>(slidingWindowElements, chrom <span class="op">+</span><span class="st"> </span>start <span class="op">+</span><span class="st"> </span>end <span class="op">+</span>numGuides <span class="op">~</span><span class="st"> </span>expt, </span>
<span id="cb20-2"><a href="#cb20-2"></a>  <span class="dt">value=</span><span class="st">&quot;meanZ&quot;</span>)</span>
<span id="cb20-3"><a href="#cb20-3"></a>p =<span class="st"> </span><span class="kw">ggplot</span>(slidingWindowElementsByRep, <span class="kw">aes</span>(<span class="dt">x=</span><span class="st">`</span><span class="dt">1</span><span class="st">`</span>, <span class="dt">y=</span><span class="st">`</span><span class="dt">2</span><span class="st">`</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Replicate 1 element effect Z score&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Replicate 2 element effect Z score&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="kw">sprintf</span>(<span class="st">&quot;r = %f&quot;</span>,<span class="kw">cor</span>(slidingWindowElementsByRep<span class="op">$</span><span class="st">`</span><span class="dt">1</span><span class="st">`</span>,slidingWindowElementsByRep<span class="op">$</span><span class="st">`</span><span class="dt">2</span><span class="st">`</span>)))<span class="op">+</span></span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="st">  </span><span class="kw">theme_classic</span>(); </span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Quite highly correlated!</p>
<div id="b-get-element-level-stats-with-annotated-elements" class="section level3">
<h3>2b) Get element level stats with annotated elements</h3>
<p>Since we have annotated elements anyway in <code>dhsPeakBED</code>, it might help us to identify which guides should be combined. This would be the only way to do it if we had only targeted these regions to begin with.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co">#the next command annotates our guides with any DHS peak they lie in.</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>annotatedGuides =<span class="st"> </span><span class="kw">findOverlappingElements</span>(<span class="dt">guides =</span> <span class="kw">unique</span>(guideLevelStats[<span class="op">!</span>guideLevelStats<span class="op">$</span>isNontargeting,</span>
<span id="cb21-3"><a href="#cb21-3"></a>  <span class="kw">c</span>(<span class="st">&quot;PAM_3primeEnd_coord&quot;</span>,<span class="st">&quot;gRNA_systematic_name&quot;</span>,<span class="st">&quot;chrom&quot;</span>)]), <span class="dt">elements =</span> dhsPeakBED, </span>
<span id="cb21-4"><a href="#cb21-4"></a>  <span class="dt">elements.start =</span> <span class="st">&quot;start&quot;</span>, <span class="dt">elements.end =</span> <span class="st">&quot;end&quot;</span>, <span class="dt">elements.chr =</span> <span class="st">&quot;chrom&quot;</span>, </span>
<span id="cb21-5"><a href="#cb21-5"></a>  <span class="dt">guides.pos =</span> <span class="st">&quot;PAM_3primeEnd_coord&quot;</span>, <span class="dt">guides.chr =</span> <span class="st">&quot;chrom&quot;</span>)</span>
<span id="cb21-6"><a href="#cb21-6"></a></span>
<span id="cb21-7"><a href="#cb21-7"></a><span class="co">#merge regulatory element annotations back onto guideLevelStats</span></span>
<span id="cb21-8"><a href="#cb21-8"></a>guideLevelStats =<span class="st"> </span><span class="kw">merge</span>(guideLevelStats, annotatedGuides[<span class="kw">c</span>(<span class="st">&quot;gRNA_systematic_name&quot;</span>, <span class="st">&quot;name&quot;</span>)],</span>
<span id="cb21-9"><a href="#cb21-9"></a>                        <span class="dt">by=</span><span class="st">&quot;gRNA_systematic_name&quot;</span>, <span class="dt">all.x=</span><span class="ot">TRUE</span>)</span>
<span id="cb21-10"><a href="#cb21-10"></a></span>
<span id="cb21-11"><a href="#cb21-11"></a><span class="co">#this is where we are actually running MAUDE to find element-level stats</span></span>
<span id="cb21-12"><a href="#cb21-12"></a>dhsPeakStats =<span class="st"> </span><span class="kw">getElementwiseStats</span>(<span class="dt">experiments =</span> <span class="kw">unique</span>(binReadMat[<span class="st">&quot;expt&quot;</span>]), </span>
<span id="cb21-13"><a href="#cb21-13"></a>  <span class="dt">normNBSummaries =</span> guideLevelStats, <span class="dt">negativeControl =</span> <span class="st">&quot;isNontargeting&quot;</span>, </span>
<span id="cb21-14"><a href="#cb21-14"></a>  <span class="dt">elementIDs =</span> <span class="st">&quot;name&quot;</span>) <span class="co"># &quot;name&quot; is the peak IDs from the DHS BED file</span></span></code></pre></div>
<pre><code>## Building background with 4478 non-targeting guides</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co">#merge peak info back into dhsPeakStats</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>dhsPeakStats =<span class="st"> </span><span class="kw">merge</span>(dhsPeakStats, dhsPeakBED, <span class="dt">by=</span><span class="st">&quot;name&quot;</span>);</span></code></pre></div>
<p>Now we can again look at the activity of the elements across the locus:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>p=<span class="kw">ggplot</span>(dhsPeakStats, <span class="kw">aes</span>(<span class="dt">x=</span>start, <span class="dt">xend=</span>end, <span class="dt">y=</span>meanZ,<span class="dt">yend=</span>meanZ, <span class="dt">colour=</span>FDR<span class="op">&lt;</span><span class="fl">0.01</span>)) <span class="op">+</span></span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">geom_segment</span>(<span class="dt">size=</span><span class="dv">1</span>)<span class="op">+</span><span class="kw">facet_grid</span>(expt <span class="op">~</span>.) <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Genomic position&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Element Z score&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>); </span>
<span id="cb24-4"><a href="#cb24-4"></a><span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAACMVBMVEUAAAAAADoAAGYAOpAAZrYAv8QZGUgZGXEZSJcZcboaGhozMzM6AAA6ADo6AGY6OpA6kNtIGRlIGXFISBlIl91NTU1NTV5NTWRNTW5NTW9NTXlNTY5NU01NWU1NWWRNWY5NXl5NY25NZE1NZKtNaX9NaatNbo5Nbp1NbqtNbrVNechNg45Ng8hNjshTTW9TXo5TXp1ZTU1ZTVNZTV5ZTWRZTW5ZZKteTU1eTVleTY5eU15eXoNjTU1kTU1kTVlkTWRkTW5kq+RmAABmADpmAGZmOpBmZmZmkJBmtv9pTU1pTY5pq+RuTU1uTVluTWRuTW5uTW9uTY5uaX9ubo5ubqtunY5uq8huq+Rutf9vTU1vTW5vTY5xGRlxGUhxGXF5TU15TW55TY5/zf+DTU2DTVODTW6DyP+OTU2OTVmOTV6OTWOOTWSOTW6OTXmOTY6OyMiOyP+O5P+QOgCQOjqQOmaQkGaQtpCQ27aQ2/+X3f+dXk2dbm6dnW6d5P+ijk2i//+raU2raV6rbk2rbm6rbo6rtY6r5Mir5P+1bk21jk21//+2ZgC2tma22/+2//+6cRm6///Ig03Ijk3I/8jI///Nq27bkDrb25Db/7bb///dl0jd///kjlnknV7kq2Pkq2nkq27kyI7k5Kvk/8jk///4dm3/tW7/tmb/unH/yHn/yIP/yI7/zX//25D/27b/3Zf/5I7/5J3/5Kv//6L//7X//7b//7r//8j//9v//+T///9+O6keAAAACXBIWXMAAA7DAAAOwwHHb6hkAAANJklEQVR4nO2diX8bRxXHldiBHnJijqWhB5irmEKBcl/mcDkEGEq5wlHO0pqjBcVACS2lkFIECExxXYHTQkKxEdSIBqeO5P3rmDc7p7Tat/eO5Pc+bWZ2duc3s1/PzI523+zWfLJIq1VdAdeNACFGgBAjQIgRIMQIEGKpARVMtjbOii02pCKlZ8wkT4AQeQKEyE8PoGPHgv9zlidAiPz0AMpqBCidPAFC5AkQIk+AEHkChMgTIESeACHyBAiRJ0CIPAFC5AkQIk+AEHkChMgTIESeACHyTgHqr3qL2zx2wfO86zaNhOiMBdbLJUAHZ5v+hZt5dKM5lBCZsch6uQSo//1Nf+/2TRY7eLhlJ0RnLLJeLgHa++y2378H0LCu5XlNI+FqZgRod1Hy2LutBa1IJ0RnLLJeLgHSDYbbRtNOIED2kMMA0Rhk28HZU+KiBX3r4FebOiE6Y5H1cgmQmPZAm2HzoJMtn+ZB5WTMJH/IAEU8miZAYAQovRGgdPIECJEnQIg8AULkCRAiT4AQeQKEyBMgRH5KAaXwdiVA6eSnFFB+8gQIkSdAiDwBQuQJECJPgBB5AoTIEyBEngAh8k4B0o/B9lbAeUG6CaEZC6yXS4C0OxA8kAcHhsBNCM2Yd72eef6jOtkhQPpR/C5g2mgKNyE0Y+71OnfFEyrZIUC2MweLCTchvzz/oMt3XBXYc2UbcgmQ5Q4EjgvCTQjNWGS9XAJktqD+6imRqsYhAmS4A+2tqOGZACnT7kCCj3ATQjMWWS+XAGn/IJj/wPAs3ITQjAXWyylABWXMJE+AEPmqAXVqtUZnZit5xtzNTUDtmb8sNwZrs4kz5m9OAtpfbrD//O7R9YQZC7DpBnQsy4txIuUr7mId6GL7y/OJMw7Z1ALyu/CeuVh8DmUXKydjJvlqAQ3WGukyKsvetSLlqwYEI3SqjMr4m8sy1ihCvmpAfsw54mhG06YY0P5y8DZQmgeZJZaeMZP8IQdk9E5HAXWqnQc5D6gDo08OM+kczElA4jJPP1atEo04AQor0dygLhZSorVV8SCNy1cNqIyMmeQnDNBOjhUJkQ9LrhbQYG3ej3lLeghQ7qjcBNQGNoqQdqASsYgXC1QMaLAW/IpsiMiskRY+pLZrNfXLXMX3bz0TWRH7Mq8dqETM4RcsQdM3IoM1dsIirVcPu4fTmdlSDUHH20eSANLOCyLm8MtNhgDxM5FpbXPIEG2En6k4TxXfX64hgOx5kHZ/EbGhFywVbJkA+Z3ZMEAdeSenN3dGtQcV787yaBQg66a9dqASMYdfsDQCqAvdhke7NdHFWANRw1E3aAmNoTgOyLSIFmRmLOhSn2qQnteAjq6rgTs4xDr5rtFVjHgyQDHHIEcAjWlBvbpqNXm0IP5oVfZT7UAlYg6/YGkEUFuOQaqHgUWPQTEAMVk2TneseRC0GXwelLvldhVrW/cmoq5iOKD9wLVjAm93RM6Dwn4ZtI15kI7HAASD1WQDUrNndcUPnUu3+XQ7OCaI+zggdniXTZXa5B9klmhu9OoMZZs8zKwSS8+YSZ4AIfIECJEnQIg8AULkCRAiXyGg/Q/K6eEEThQLNA1oWUwnCZBdoozsL3+kHtxxJEBWiTICP2o7/O4+AbJKlBH+q5/91qOlCEMlyoi8v1Y7+nsCZJYoI8oHuE1OnFaJo0n6gp8wY56W8HFQgRUpu8CYRoBKtF5d3GXkd6R7x4MOAl7hbDAJdoY8UhV2KAAJJH73w/Nqi4+5nZkttXOMTQugnVFT+ySDwQ9/8qEtucUD1qSSAErkxOmYxQHUO7HVbsgt/uTD2DnOpgVQlPFhhv3Q7Mz73Vmjw/GhJxiDxt+H14A66kIRz8Vscky1mRoMy2aT6c2l6WJTZ3LUOcGaSbshtrqBy1SjsEF6giaKgkEH/vzdWfMqlnCQFv1x6n5qBAwGP4J/92+9rx4MIzAPUmNQbWzfsZ+sJhh9JghQJks9Bh1GQNlXPednTgJKNAOKUdMsi8SdBJT3ot6pA1ROxkzyBAiRrxoQvYFqtERzg95AFVKiEac3UIWVaMQJUFiJ5kZeb6DKwdwERG+gCimx9IyZ5AkQIp8GkHAun/lzXfxMCG5/sH+xRz4jFcnxflDWl3Xl24I4koCLetIDgJCbZcMVyfN+UNmAjo2asdcApLikADTJ94NiA8rWgiYXULQFgOQDnqExKPqnVcT9IL08THxxxN31YpipFgSLdYb7WoKKWIO0sUw+eJG9w+vmMdNdDBZ2B6vqeifQ5/LDFVGrrrjpJariWxEOr5vHTAPiF6K2WCqWbZDWi5zFF0eG1s2nqmlsK+wyz5f5toMfDNgjn+GK2IO0XiYvvjji8Lr5As0eg8wmZy+TZ+NQ+Lr5MuplJDt0094echigCR6DMtj4AvUyefHFEYfXzRdoEQXqdfPiiyOTOw/KYJXetI/4veYmoLJv2k8aILonHVaiESdAYSWaG3TTPqREa4tu2o+WWHrGTPIECJGvdlGvNBqkzRJLz5hJngAh8lUvyeRTIJoHWSXKCAEaU6KMEKAxJcoIARpToowQoDElyggBGlOijBCgMSXKSJEz6RSeHu4BKjIjAcrfCFA6eQKEyBMgRN4pQPo54d4KeHdIPyo0Y4H1cgmQ9pcCjwXw8Aj8qNCM+dXr8h1XQnDuOT9VyQ4B0r4Ku4Bpoyn8qNCM+dXr8lde8EII/3XFEzLZIUC2twuLCT8qvzwHqstfffSPVwahTHYIkOUvBZ4dwo8KzZhfvQDMOdZ63G9B/dVTIlWNQ2UB8p953lWuj0HsKqaG51IBhSQ7BEj7Swk+wo8KzVhkvVwCpB2oYP4Dw7Pwo0IzFlgvpwAVlDGTPAFC5AkQIk+AEHkChMgTIESeACHyBAiRnwZA+Xz0kAClk58GQPkYAUonT4AQeQKEyBMgRJ4AIfIECJEnQIg8AULkCRAiT4AQ+UkHtJPPD7Fx8lMDaCclKCPXlAISdkgAaQcqEaM3L1imHahEbILfQJXB4jgviBi9/cU27f4iYkNvoCrYxlTXIUDagUrE6A1UtkW0IDNjbjOfWPVyCVCMMWjHP8yAtAOViI2+gaogOBH1cgmQ8QYqmgeVmTGTPAFC5CcWUO6jEQFKJK+TJxVQ7kaA0skTIESeACHyBAiRJ0CIPAFC5AkQIk+AEHkChMgTIESeACHyBAiRJ0BKPtnjoAIrkjrjiI19VJZ4R9RDtzxPPtZ55id1dW47xmaowAgQYgQIsdL79KQZAUKMACFGgBAjQIilALS3wl/1JgLjuf1TK961XzMDb8lbfNzzvBcvmTse5+9KWfzHqvfKj3rXPaYCbkvegvVJzjC3gFItOaD+atO/sLgtAsN/8W9e8+D+V2zL4JrWwS/e2rrw8ibkMHawFDj6/A3N/p03+eevv1sEIPM0C35zE5Ri+0Xa7pGlWnJAtjuV4Tv0n9f/rn/v11si+Oe1LPHnzf+94zTkMHawFDj64lse2vv0xzYvvfe0CJjMY9/78ubBL9856pM09LW8Mi0rICO4+OYH9z5zV0sEkMiCS0usx7xt29jBU+4eOpoFTOZnr2UorU9yhjq3lWopu9jJlggM/8VLS1/YXTjZEgFLfPr6j/sX3/RN/9kVcwdL2X31A61/v+jB/ur7W0+qwO9/97ZHFrf3Pvmllv4kZ6h7ZKmWbpD+/MMtEZh/4u+83XvDAy0Z3PPr1TeK0/rTLdYOdvRvm9BmLt7ife5dKuh/+1VPiZaiPsk5iS0IDMaEIBgaK+79xqYMPrX0AzlybDTNHbfzwYmNQbDz0vt08J4PyLFGfZJzEscg+EuyK4oIDP9FuG7d/xoZ/JVds1jiky/d9p/9xGljB0s5OPvuzfM3nOp/63W+DvzzL2mxHLsLNxuf5Ax1jyzVUrSgXY/PSURgTFT+7nk33imDhWBeA7Oek4+YOyDlmi/yedDLPDO48a4WyCxYn+ScwHnQITMChBgBQowAIUaAECNAiKUA1IHHU42YB/fmzsQ97L9/iHt0mZYY0GCNf/8n5tdYE5iDcMASAxKfRor5TfEENiWABmvzRpx/KKk3d1+d9znYnvXF9nyPJ8Jpi3Sw3tyPazVgK9PgKH5YkEcfrVQrtqSA+Fe2AuPfXWctqVdnZ9w5ug7b8H+wXQsS2SlDmszWq+vj+LHQbHr1BgshKo7WKrE+VFWoJQUkzqhWO3KGdzZ25uz8eLr8OFmwLRLFmavsw8ceX5eyApCtUn23S9uCWNU7gbvFfMCMnRp0HQlE/iNPWRhPZhryWL8tepoGNKJSraUdgwCQGKczAeJffuM9cUoAyWEBTuVIUHsFCLa7/GQtQKNd7Pi6PJYnQjfVgEZUqrXkE8V2MA+a2RqssT82Ox95KvbAqwHJdLDhQZozCg6DzhuqUq2lmEl35UwaLshHzuhTURdoG9DIZX7W15d5EBMa7dpsqEq1VvJvMQfOOKERIMQIEGJ0uwMxAoQYAUKMACFGgBAjQIgRIMT+DxahYYbWIRmmAAAAAElFTkSuQmCC" /><!-- --></p>
<p>And the correlation between replicates.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>dhsPeakStatsByRep =<span class="st"> </span><span class="kw">cast</span>(dhsPeakStats, name <span class="op">~</span><span class="st"> </span>expt, <span class="dt">value=</span><span class="st">&quot;meanZ&quot;</span>)</span>
<span id="cb25-2"><a href="#cb25-2"></a></span>
<span id="cb25-3"><a href="#cb25-3"></a>p =<span class="st"> </span><span class="kw">ggplot</span>(dhsPeakStatsByRep, <span class="kw">aes</span>(<span class="dt">x=</span><span class="st">`</span><span class="dt">1</span><span class="st">`</span>, <span class="dt">y=</span><span class="st">`</span><span class="dt">2</span><span class="st">`</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb25-4"><a href="#cb25-4"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Replicate 1 DHS effect Z score&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Replicate 2 DHS effect Z score&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb25-5"><a href="#cb25-5"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="kw">sprintf</span>(<span class="st">&quot;r = %f&quot;</span>,<span class="kw">cor</span>(dhsPeakStatsByRep<span class="op">$</span><span class="st">`</span><span class="dt">1</span><span class="st">`</span>,dhsPeakStatsByRep<span class="op">$</span><span class="st">`</span><span class="dt">2</span><span class="st">`</span>)))<span class="op">+</span><span class="kw">theme_classic</span>(); </span>
<span id="cb25-6"><a href="#cb25-6"></a><span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Again, these are highly correlated. In this case, it didn’t look like the regulatory element annotations helped our analysis, but that is not always true.</p>
<p>Let’s see investigate why this might be by looking at the guide effect sizes for the guides within each DHS element.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>p=<span class="kw">ggplot</span>(guideLevelStats, <span class="kw">aes</span>(<span class="dt">x=</span>Z, <span class="dt">group=</span>name, <span class="dt">colour=</span>name <span class="op">==</span><span class="st"> &quot;chr12:9912678-9915275&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">stat_ecdf</span>(<span class="dt">alpha=</span><span class="fl">0.3</span>)<span class="op">+</span><span class="st"> </span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="st">  </span><span class="kw">stat_ecdf</span>(<span class="dt">data=</span>guideLevelStats[<span class="op">!</span><span class="kw">is.na</span>(guideLevelStats<span class="op">$</span>name) <span class="op">&amp;</span></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="st">                                   </span>guideLevelStats<span class="op">$</span>name<span class="op">==</span><span class="st">&quot;chr12:9912678-9915275&quot;</span>,], <span class="dt">size=</span><span class="dv">1</span>)<span class="op">+</span></span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="st">  </span><span class="kw">facet_grid</span>(expt <span class="op">~</span>.) <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Guide Z score&quot;</span>)<span class="op">+</span><span class="kw">scale_y_continuous</span>(<span class="dt">expand=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_colour_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;red&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">colour =</span> <span class="st">&quot;CD69 promoter?&quot;</span>)<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Cumulative fraction&quot;</span>); </span>
<span id="cb26-7"><a href="#cb26-7"></a><span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Here, the promoter DHS peak is in red and all the other DHS peaks are in black. You can appreciate that the promoter tends to have among the most influencial guides (rightward shift in the CDF curves). Even for the promoter, there is substantial variability in the estimated guide effect sizes, ranging from not doing anything (near 0) to pretty sizable effects (&gt;3). This is probably a combination of factors, including experimental noise, how effective each guide targets the region, and the effect of actually targeting each region.</p>
<p>Let’s zoom in on the promoter to see what exactly is happening here.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>p=<span class="kw">ggplot</span>(guideLevelStats[<span class="op">!</span><span class="kw">is.na</span>(guideLevelStats<span class="op">$</span>name) <span class="op">&amp;</span><span class="st"> </span>guideLevelStats<span class="op">$</span>name<span class="op">==</span><span class="st">&quot;chr12:9912678-9915275&quot;</span>,],</span>
<span id="cb27-2"><a href="#cb27-2"></a>         <span class="kw">aes</span>(<span class="dt">x=</span>PAM_3primeEnd_coord, <span class="dt">y=</span>Z, <span class="dt">colour=</span>expt)) <span class="op">+</span></span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">1</span>)<span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>()<span class="op">+</span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Genomic position&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Guide Z score&quot;</span>)<span class="op">+</span></span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">9913497</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>); </span>
<span id="cb27-5"><a href="#cb27-5"></a><span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Here, I’ve marked the transcription start site with a vertical black line. CD69 is an antisense gene, so it is transcribed to the left of the black line. The guides targeting the 5’ UTR of CD69 (left of black line) appear to be less effective than those in the promoter (right of black line), which is expected. The high correlation in the guide effect sizes between the two experiments indicates that many of the low-effect size guides cannot be attributed to experimental noise. So probably most of the signal diversity within the promoter DHS is attributable to how effective the guide is at targeting the DNA, and how effective the activation domain of CRISPRa is where it is bound.</p>
<p>Now let’s look more closely at the guides and select a few that work especially well.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>p=<span class="kw">ggplot</span>(guideEffectsByRep[guideEffectsByRep<span class="op">$</span>PAM_3primeEnd_coord <span class="op">&lt;</span><span class="st"> </span><span class="dv">9915275</span> <span class="op">&amp;</span><span class="st"> </span></span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="st">                             </span>guideEffectsByRep<span class="op">$</span>PAM_3primeEnd_coord <span class="op">&gt;</span><span class="st"> </span><span class="dv">9912678</span>,], </span>
<span id="cb28-3"><a href="#cb28-3"></a>         <span class="kw">aes</span>(<span class="dt">x=</span><span class="st">`</span><span class="dt">2</span><span class="st">`</span>, <span class="dt">y=</span><span class="st">`</span><span class="dt">1</span><span class="st">`</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb28-4"><a href="#cb28-4"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data=</span>guideEffectsByRep[guideEffectsByRep<span class="op">$</span>PAM_3primeEnd_coord <span class="op">&lt;</span><span class="st"> </span><span class="dv">9915275</span> <span class="op">&amp;</span><span class="st"> </span></span>
<span id="cb28-5"><a href="#cb28-5"></a><span class="st">                                     </span>guideEffectsByRep<span class="op">$</span>PAM_3primeEnd_coord <span class="op">&gt;</span><span class="st"> </span><span class="dv">9912678</span> <span class="op">&amp;</span><span class="st"> </span></span>
<span id="cb28-6"><a href="#cb28-6"></a><span class="st">                                     </span>guideEffectsByRep<span class="op">$</span><span class="st">`</span><span class="dt">1</span><span class="st">`</span><span class="op">&gt;</span><span class="dv">2</span> <span class="op">&amp;</span><span class="st"> </span>guideEffectsByRep<span class="op">$</span><span class="st">`</span><span class="dt">2</span><span class="st">`</span><span class="op">&gt;</span><span class="dv">2</span>,],</span>
<span id="cb28-7"><a href="#cb28-7"></a>            <span class="kw">aes</span>(<span class="dt">label=</span>gRNA_systematic_name)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb28-8"><a href="#cb28-8"></a><span class="st">  </span><span class="kw">theme_classic</span>()<span class="op">+</span><span class="kw">xlab</span>(<span class="st">&quot;Replicate 2 guide Z score&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Replicate 1 guide Z score&quot;</span>); </span>
<span id="cb28-9"><a href="#cb28-9"></a><span class="kw">print</span>(p) </span></code></pre></div>
<pre><code>## Warning: Removed 2239 rows containing missing values (geom_point).</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see that, although there are four guides that have a large effect in one replicate, they don’t have as great an effect in the other. Here, I’ve labeled the IDs of three guides that have a Z score over two in both replicates. If I were going to follow up targeting the CD69 promoter with more guides, these are the ones I would use.</p>
<p><code>GenomicRanges</code> is a great package to work with data associated with genomic coordinates. First, let’s restructure our tiling element data.frame so that there is only one row per region and there is one of each data field for each replicate.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>slidingWindowElementsByReplicate =<span class="st"> </span><span class="kw">cast</span>(<span class="kw">melt</span>(slidingWindowElements, </span>
<span id="cb30-2"><a href="#cb30-2"></a>  <span class="dt">id.vars=</span><span class="kw">c</span>(<span class="st">&quot;expt&quot;</span>,<span class="st">&quot;numGuides&quot;</span>,<span class="st">&quot;chrom&quot;</span>,<span class="st">&quot;start&quot;</span>,<span class="st">&quot;end&quot;</span>)), </span>
<span id="cb30-3"><a href="#cb30-3"></a>  numGuides<span class="op">+</span>chrom<span class="op">+</span>start<span class="op">+</span>end <span class="op">~</span><span class="st"> </span>variable<span class="op">+</span>expt, <span class="dt">value=</span><span class="st">&quot;value&quot;</span>)</span>
<span id="cb30-4"><a href="#cb30-4"></a><span class="kw">head</span>(slidingWindowElementsByReplicate)</span></code></pre></div>
<pre><code>##   numGuides chrom   start     end  stoufferZ_1 stoufferZ_2      meanZ_1
## 1         5 chr12 9882993 9883182 -0.009472366 -0.23953341 -0.004236171
## 2         5 chr12 9888047 9888212 -0.213765598 -0.35832774 -0.095598882
## 3         5 chr12 9893958 9894158  0.147176395  0.13554497  0.065819285
## 4         5 chr12 9898697 9898894  0.112898517 -0.03747552  0.050489752
## 5         5 chr12 9898702 9898898  0.135955105 -0.03142427  0.060800971
## 6         5 chr12 9901267 9901451 -0.021920411 -0.08749781 -0.009803106
##       meanZ_2 significanceZ_1 significanceZ_2  p.value_1  p.value_2     FDR_1
## 1 -0.10712260     -0.06312389      -1.1555161 0.47483393 0.12393957 0.9766595
## 2 -0.16024904     -1.42453488      -1.7285834 0.07714585 0.04194184 0.3298285
## 3  0.06061755      0.98078414       0.6538729 0.16334960 0.25659686 0.5474325
## 4 -0.01675956      0.75235621      -0.1807830 0.22591844 0.42826896 0.6618633
## 5 -0.01405336      0.90600541      -0.1515916 0.18246649 0.43975453 0.5845606
## 6 -0.03913021     -0.14607771      -0.4220920 0.44193002 0.33647895 0.9453980
##       FDR_2
## 1 0.4331700
## 2 0.2181068
## 3 0.6724070
## 4 0.9145821
## 5 0.9262791
## 6 0.7939421</code></pre>
<p>We can convert our data structures to <code>GRanges</code> objects as easily as this:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="co">#casting to data.frame is only needed if using cast</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>slidingWindowElementsByReplicateGR =<span class="st"> </span><span class="kw">GRanges</span>(<span class="kw">as.data.frame</span>(slidingWindowElementsByReplicate)) </span></code></pre></div>
<p>Now let’s label those ranges that were significant in both replicates, and merge overlapping significant ranges to get a set of expanded active regions.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="co">#require that both replicates are significant at an FDR of 0.1 and that the signs agree</span></span>
<span id="cb33-2"><a href="#cb33-2"></a>slidingWindowElementsByReplicateGR<span class="op">$</span>significantUp   =<span class="st"> </span>slidingWindowElementsByReplicateGR<span class="op">$</span>FDR_<span class="dv">1</span><span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span> <span class="op">&amp;</span><span class="st"> </span></span>
<span id="cb33-3"><a href="#cb33-3"></a><span class="st">  </span>slidingWindowElementsByReplicateGR<span class="op">$</span>FDR_<span class="dv">2</span> <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span> <span class="op">&amp;</span><span class="st"> </span>slidingWindowElementsByReplicateGR<span class="op">$</span>meanZ_<span class="dv">1</span> <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span></span>
<span id="cb33-4"><a href="#cb33-4"></a><span class="st">  </span>slidingWindowElementsByReplicateGR<span class="op">$</span>meanZ_<span class="dv">2</span> <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>; </span>
<span id="cb33-5"><a href="#cb33-5"></a>slidingWindowElementsByReplicateGR<span class="op">$</span>significantDown =<span class="st"> </span>slidingWindowElementsByReplicateGR<span class="op">$</span>FDR_<span class="dv">1</span><span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span> <span class="op">&amp;</span></span>
<span id="cb33-6"><a href="#cb33-6"></a><span class="st">  </span>slidingWindowElementsByReplicateGR<span class="op">$</span>FDR_<span class="dv">2</span> <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span> <span class="op">&amp;</span><span class="st"> </span>slidingWindowElementsByReplicateGR<span class="op">$</span>meanZ_<span class="dv">1</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span></span>
<span id="cb33-7"><a href="#cb33-7"></a><span class="st">  </span>slidingWindowElementsByReplicateGR<span class="op">$</span>meanZ_<span class="dv">2</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>;</span>
<span id="cb33-8"><a href="#cb33-8"></a></span>
<span id="cb33-9"><a href="#cb33-9"></a><span class="co">#merge overlapping regions in each set</span></span>
<span id="cb33-10"><a href="#cb33-10"></a>overlappingSlidingWindowElementsUp =</span>
<span id="cb33-11"><a href="#cb33-11"></a><span class="st">  </span><span class="kw">reduce</span>(slidingWindowElementsByReplicateGR[slidingWindowElementsByReplicateGR<span class="op">$</span>significantUp])</span>
<span id="cb33-12"><a href="#cb33-12"></a>overlappingSlidingWindowElementsDown =</span>
<span id="cb33-13"><a href="#cb33-13"></a><span class="st">  </span><span class="kw">reduce</span>(slidingWindowElementsByReplicateGR[slidingWindowElementsByReplicateGR<span class="op">$</span>significantDown])</span></code></pre></div>
<p>Now let’s plot it all together as a genome browser track!</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="co">#which gene models do I want to plot?</span></span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="kw">data</span>(genesymbol, <span class="dt">package =</span> <span class="st">&quot;biovizBase&quot;</span>)</span>
<span id="cb34-3"><a href="#cb34-3"></a>wh &lt;-<span class="st"> </span>genesymbol[<span class="kw">c</span>(<span class="st">&quot;CD69&quot;</span>, <span class="st">&quot;CLECL1&quot;</span>, <span class="st">&quot;KLRF1&quot;</span>, <span class="st">&quot;CLEC2D&quot;</span>,<span class="st">&quot;CLEC2B&quot;</span>)]</span>
<span id="cb34-4"><a href="#cb34-4"></a>wh &lt;-<span class="st"> </span><span class="kw">range</span>(wh, <span class="dt">ignore.strand =</span> <span class="ot">TRUE</span>)</span>
<span id="cb34-5"><a href="#cb34-5"></a></span>
<span id="cb34-6"><a href="#cb34-6"></a><span class="co">#make the genome tracks</span></span>
<span id="cb34-7"><a href="#cb34-7"></a><span class="kw">tracks</span>(<span class="kw">autoplot</span>(Homo.sapiens, <span class="dt">which =</span> wh, <span class="dt">gap.geom=</span><span class="st">&quot;chevron&quot;</span>), </span>
<span id="cb34-8"><a href="#cb34-8"></a>  <span class="kw">autoplot</span>(overlappingSlidingWindowElementsUp, <span class="dt">fill=</span><span class="st">&quot;red&quot;</span>), </span>
<span id="cb34-9"><a href="#cb34-9"></a>  <span class="kw">autoplot</span>(overlappingSlidingWindowElementsDown, <span class="dt">fill=</span><span class="st">&quot;blue&quot;</span>), <span class="dt">heights=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<pre><code>## Parsing transcripts...</code></pre>
<pre><code>## Parsing exons...</code></pre>
<pre><code>## Parsing cds...</code></pre>
<pre><code>## Parsing utrs...</code></pre>
<pre><code>## ------exons...</code></pre>
<pre><code>## ------cdss...</code></pre>
<pre><code>## ------introns...</code></pre>
<pre><code>## ------utr...</code></pre>
<pre><code>## aggregating...</code></pre>
<pre><code>## Done</code></pre>
<pre><code>## &#39;select()&#39; returned 1:1 mapping between keys and columns</code></pre>
<pre><code>## Constructing graphics...</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Here, the red are CD69-activating regions, blue are CD69-repressing regions.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
