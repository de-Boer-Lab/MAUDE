<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Carl de Boer" />


<title>A tutorial with simulated data</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>
<style type="text/css">
a.anchor-section {margin-left: 10px; visibility: hidden; color: inherit;}
a.anchor-section::before {content: '#';}
.hasAnchor:hover a.anchor-section {visibility: visible;}
</style>
<script>// Anchor sections v1.0 written by Atsushi Yasumoto on Oct 3rd, 2020.
document.addEventListener('DOMContentLoaded', function() {
  // Do nothing if AnchorJS is used
  if (typeof window.anchors === 'object' && anchors.hasOwnProperty('hasAnchorJSLink')) {
    return;
  }

  const h = document.querySelectorAll('h1, h2, h3, h4, h5, h6');

  // Do nothing if sections are already anchored
  if (Array.from(h).some(x => x.classList.contains('hasAnchor'))) {
    return null;
  }

  // Use section id when pandoc runs with --section-divs
  const section_id = function(x) {
    return ((x.classList.contains('section') || (x.tagName === 'SECTION'))
            ? x.id : '');
  };

  // Add anchors
  h.forEach(function(x) {
    const id = x.id || section_id(x.parentElement);
    if (id === '') {
      return null;
    }
    let anchor = document.createElement('a');
    anchor.href = '#' + id;
    anchor.classList = ['anchor-section'];
    x.classList.add('hasAnchor');
    x.appendChild(anchor);
  });
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">A tutorial with simulated data</h1>
<h4 class="author">Carl de Boer</h4>
<h4 class="date">5/21/2020</h4>



<div id="a-tutorial-with-simulated-data" class="section level1">
<h1>A tutorial with simulated data</h1>
<p>The following is an example that relies on simulated data and makes use of the <code>ggplot2</code> and <code>reshape</code> R packages. Since there is no data to load for this example, it should be relatively easy to run and to inspect the variables to better understand the desired formats. This should also help make clear the underlying assumptions of the model since the data are generated with many of these same assumptions.</p>
<div id="create-the-simulated-experimental-data" class="section level2">
<h2>Create the simulated experimental data</h2>
<p>Load the required packages and set the seed. You only need to set the seed if you want your analysis to get exactly the same results as what is shown here. Otherwise, you can skip this step (and note that if you run things in a different order, the results may differ).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(reshape)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">library</span>(MAUDE)</span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">set.seed</span>(<span class="dv">76484377</span>)</span></code></pre></div>
<p>Set up the simulation. Here, we’re using 5 guides per element, and 200 elements, 100 of which have no effect on expression. The half that affect expression have effect sizes ranging from 0.01 to 1 standard deviations. We also include 1000 non-targeting guides.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co">#ground truth</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>groundTruth =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">element =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">200</span>, <span class="dt">meanEffect =</span> <span class="kw">c</span>((<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>)<span class="op">/</span><span class="dv">100</span>,<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">100</span>))) <span class="co">#targeting 200 elements, half of which do nothing</span></span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co">#guide - element map; 5 guides per element; gid is the guide ID</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>guideMap =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">element =</span> <span class="kw">rep</span>(groundTruth<span class="op">$</span>element, <span class="dv">5</span>), <span class="dt">gid =</span> <span class="dv">1</span><span class="op">:</span>(<span class="dv">5</span><span class="op">*</span><span class="kw">nrow</span>(groundTruth)), <span class="dt">NT=</span><span class="ot">FALSE</span>, <span class="dt">mean=</span><span class="kw">rep</span>(groundTruth<span class="op">$</span>meanEffect, <span class="dv">5</span>))</span>
<span id="cb2-6"><a href="#cb2-6"></a>guideMap =<span class="st"> </span><span class="kw">rbind</span>(guideMap, <span class="kw">data.frame</span>(<span class="dt">element =</span> <span class="ot">NA</span>, <span class="dt">gid =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>)<span class="op">+</span><span class="kw">nrow</span>(guideMap), <span class="dt">NT=</span><span class="ot">TRUE</span>, <span class="dt">mean=</span><span class="dv">0</span>)); <span class="co"># 1000 non-targeting guides</span></span>
<span id="cb2-7"><a href="#cb2-7"></a></span>
<span id="cb2-8"><a href="#cb2-8"></a>guideMap<span class="op">$</span>abundance =<span class="st"> </span><span class="kw">rpois</span>(<span class="dt">n=</span><span class="kw">nrow</span>(guideMap), <span class="dt">lambda=</span><span class="dv">1000</span>); <span class="co">#guide abundance drawing from a poisson distribution with mean=1000</span></span>
<span id="cb2-9"><a href="#cb2-9"></a>guideMap<span class="op">$</span>cells =<span class="st"> </span><span class="kw">rpois</span>(<span class="dt">n=</span><span class="kw">nrow</span>(guideMap), <span class="dt">lambda=</span>guideMap<span class="op">$</span>abundance); <span class="co">#cell count drawing from a poisson distribution with mean the abundance from above</span></span>
<span id="cb2-10"><a href="#cb2-10"></a></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co">#create observarions for different guides, with expression drawn from normal(mean=mean, sd=1)</span></span>
<span id="cb2-12"><a href="#cb2-12"></a>cellObservations =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">gid =</span> <span class="kw">rep</span>(guideMap<span class="op">$</span>gid, guideMap<span class="op">$</span>cells))</span>
<span id="cb2-13"><a href="#cb2-13"></a>cellObservations =<span class="st"> </span><span class="kw">merge</span>(cellObservations, guideMap, <span class="dt">by=</span><span class="st">&quot;gid&quot;</span>)</span>
<span id="cb2-14"><a href="#cb2-14"></a>cellObservations<span class="op">$</span>expression =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n=</span><span class="kw">nrow</span>(cellObservations), <span class="dt">mean=</span>cellObservations<span class="op">$</span>mean);</span>
<span id="cb2-15"><a href="#cb2-15"></a></span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="co">#create the bin model for this experiment - this represents 6 bins, each of which are 10%, where A+B+C catch the bottom ~30% and D+E+F catch the top 30%; in an actual experiment, the true captured fractions should be used here. </span></span>
<span id="cb2-17"><a href="#cb2-17"></a>binBounds =<span class="st"> </span><span class="kw">makeBinModel</span>(<span class="kw">data.frame</span>(<span class="dt">Bin=</span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>,<span class="st">&quot;D&quot;</span>,<span class="st">&quot;E&quot;</span>,<span class="st">&quot;F&quot;</span>), <span class="dt">fraction=</span><span class="kw">rep</span>(<span class="fl">0.1</span>,<span class="dv">6</span>)))</span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="cf">if</span>(<span class="ot">FALSE</span>){ </span>
<span id="cb2-19"><a href="#cb2-19"></a>  <span class="co"># in reality, we shouldn&#39;t assume this distribution is exactly normal - we can re-assign expression bin bounds based on quantiles </span></span>
<span id="cb2-20"><a href="#cb2-20"></a>  <span class="co"># of the actual simulated expression distribution.  If you run the next two lines, the answer will improve slightly, but the </span></span>
<span id="cb2-21"><a href="#cb2-21"></a>  <span class="co"># resulting graphs will look slightly different than those below.</span></span>
<span id="cb2-22"><a href="#cb2-22"></a>  <span class="co"># correct for the actual distribution</span></span>
<span id="cb2-23"><a href="#cb2-23"></a>  binBounds<span class="op">$</span>binStartZ =<span class="st"> </span><span class="kw">quantile</span>(cellObservations<span class="op">$</span>expression, <span class="dt">probs =</span> binBounds<span class="op">$</span>binStartQ);</span>
<span id="cb2-24"><a href="#cb2-24"></a>  binBounds<span class="op">$</span>binEndZ =<span class="st"> </span><span class="kw">quantile</span>(cellObservations<span class="op">$</span>expression, <span class="dt">probs =</span> binBounds<span class="op">$</span>binEndQ);</span>
<span id="cb2-25"><a href="#cb2-25"></a>}</span>
<span id="cb2-26"><a href="#cb2-26"></a></span>
<span id="cb2-27"><a href="#cb2-27"></a><span class="co"># select some examples to inspect for both</span></span>
<span id="cb2-28"><a href="#cb2-28"></a>exampleNT =<span class="st"> </span><span class="kw">sample</span>(guideMap<span class="op">$</span>gid[guideMap<span class="op">$</span>NT],<span class="dv">10</span>);<span class="co"># non-targeting</span></span>
<span id="cb2-29"><a href="#cb2-29"></a>exampleT =<span class="st"> </span><span class="kw">sample</span>(guideMap<span class="op">$</span>gid[<span class="op">!</span>guideMap<span class="op">$</span>NT],<span class="dv">5</span>);<span class="co"># and targeting guides</span></span>
<span id="cb2-30"><a href="#cb2-30"></a></span>
<span id="cb2-31"><a href="#cb2-31"></a><span class="co">#plot the select examples and show the bin structure</span></span>
<span id="cb2-32"><a href="#cb2-32"></a>p =<span class="st"> </span><span class="kw">ggplot</span>(cellObservations[cellObservations<span class="op">$</span>gid <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(exampleT, exampleNT),], </span>
<span id="cb2-33"><a href="#cb2-33"></a>  <span class="kw">aes</span>(<span class="dt">x=</span>expression, <span class="dt">group=</span>gid, <span class="dt">fill=</span>NT))<span class="op">+</span><span class="kw">geom_density</span>(<span class="dt">alpha=</span><span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-34"><a href="#cb2-34"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">sort</span>(<span class="kw">unique</span>(<span class="kw">c</span>(binBounds<span class="op">$</span>binStartZ,binBounds<span class="op">$</span>binEndZ))),<span class="dt">colour=</span><span class="st">&quot;gray&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-35"><a href="#cb2-35"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;darkgray&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Target expression&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-36"><a href="#cb2-36"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-37"><a href="#cb2-37"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim=</span><span class="kw">c</span>(<span class="kw">min</span>(cellObservations<span class="op">$</span>expression), <span class="kw">max</span>(cellObservations<span class="op">$</span>expression)))<span class="op">+</span><span class="st"> </span></span>
<span id="cb2-38"><a href="#cb2-38"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">data=</span>binBounds, <span class="kw">aes</span>(<span class="dt">x=</span>binStartZ, <span class="dt">xend=</span>binEndZ, <span class="dt">colour=</span>Bin, <span class="dt">y=</span><span class="dv">0</span>, <span class="dt">yend=</span><span class="dv">0</span>), <span class="dt">size=</span><span class="dv">5</span>, <span class="dt">inherit.aes =</span> <span class="ot">FALSE</span>); </span>
<span id="cb2-39"><a href="#cb2-39"></a><span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Now that we’ve set up our experimental system, we simulate actually capturing cells in the bins</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co">#for each bin, find which cells landed within the bin bounds</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(binBounds)){</span>
<span id="cb3-3"><a href="#cb3-3"></a>  cellObservations[[<span class="kw">as.character</span>(binBounds<span class="op">$</span>Bin[i])]] =<span class="st"> </span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="st">    </span>cellObservations<span class="op">$</span>expression <span class="op">&gt;</span><span class="st"> </span>binBounds<span class="op">$</span>binStartZ[i] <span class="op">&amp;</span><span class="st"> </span>cellObservations<span class="op">$</span>expression <span class="op">&lt;</span><span class="st"> </span>binBounds<span class="op">$</span>binEndZ[i];</span>
<span id="cb3-5"><a href="#cb3-5"></a>}</span>
<span id="cb3-6"><a href="#cb3-6"></a></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co">#count the number of cells that ended up in each bin for each guide</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>binLevelData =<span class="st"> </span><span class="kw">cast</span>(<span class="kw">melt</span>(cellObservations[<span class="kw">c</span>(<span class="st">&quot;gid&quot;</span>,<span class="st">&quot;element&quot;</span>,<span class="st">&quot;NT&quot;</span>,<span class="kw">as.character</span>(binBounds<span class="op">$</span>Bin))], </span>
<span id="cb3-9"><a href="#cb3-9"></a>  <span class="dt">id.vars=</span><span class="kw">c</span>(<span class="st">&quot;gid&quot;</span>,<span class="st">&quot;element&quot;</span>,<span class="st">&quot;NT&quot;</span>)), gid <span class="op">+</span><span class="st"> </span>element <span class="op">+</span><span class="st"> </span>NT <span class="op">+</span><span class="st"> </span>variable <span class="op">~</span><span class="st"> </span>., <span class="dt">fun.aggregate =</span> sum)</span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="kw">names</span>(binLevelData)[(<span class="kw">ncol</span>(binLevelData)<span class="op">-</span><span class="dv">1</span>)<span class="op">:</span><span class="kw">ncol</span>(binLevelData)]=<span class="kw">c</span>(<span class="st">&quot;Bin&quot;</span>,<span class="st">&quot;cells&quot;</span>);</span>
<span id="cb3-11"><a href="#cb3-11"></a></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="co">#plot the cells/bin for each of our example guides</span></span>
<span id="cb3-13"><a href="#cb3-13"></a>p =<span class="st"> </span><span class="kw">ggplot</span>(binLevelData[binLevelData<span class="op">$</span>gid <span class="op">%in%</span><span class="st"> </span>exampleNT,], <span class="kw">aes</span>(<span class="dt">x=</span>Bin, <span class="dt">group=</span>Bin, <span class="dt">y=</span>cells)) <span class="op">+</span></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">fill=</span><span class="st">&quot;darkgray&quot;</span>)<span class="op">+</span><span class="kw">geom_line</span>(<span class="dt">data=</span>binLevelData[binLevelData<span class="op">$</span>gid <span class="op">%in%</span><span class="st"> </span>exampleT,], </span>
<span id="cb3-15"><a href="#cb3-15"></a>    <span class="kw">aes</span>(<span class="dt">group=</span>gid), <span class="dt">colour=</span><span class="st">&quot;red&quot;</span>)<span class="op">+</span><span class="st">  </span><span class="kw">theme_classic</span>()  <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Expression bin&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Captured cells/bin&quot;</span>)  <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)); <span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Now, we simulate sequencing the guides that end up in each bin, assuming we sequence 10 reads per sorted cell</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co">#get the total number of cells sorted into each of the bins</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>totalCellsPerBin =<span class="st"> </span><span class="kw">cast</span>(binLevelData,Bin <span class="op">~</span><span class="st"> </span>., <span class="dt">value=</span><span class="st">&quot;cells&quot;</span>, <span class="dt">fun.aggregate =</span> sum)</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="kw">names</span>(totalCellsPerBin)[<span class="kw">ncol</span>(totalCellsPerBin)]=<span class="st">&quot;totalCells&quot;</span>;</span>
<span id="cb4-4"><a href="#cb4-4"></a></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co">#add bin totals to binLevelData</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>binLevelData =<span class="st"> </span><span class="kw">merge</span>(binLevelData, totalCellsPerBin, <span class="dt">by=</span><span class="st">&quot;Bin&quot;</span>)</span>
<span id="cb4-7"><a href="#cb4-7"></a></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co">#generate reads for each guide per bin, following a negative binomial distribution</span></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="co">#n=number of observations; size= total reads per bin; prob= probability of not getting a read at each drawing</span></span>
<span id="cb4-10"><a href="#cb4-10"></a>binLevelData<span class="op">$</span>reads =<span class="st"> </span><span class="kw">rnbinom</span>(<span class="dt">n=</span><span class="kw">nrow</span>(binLevelData), <span class="dt">size=</span>binLevelData<span class="op">$</span>totalCells<span class="op">*</span><span class="dv">10</span>, </span>
<span id="cb4-11"><a href="#cb4-11"></a>  <span class="dt">prob=</span><span class="dv">1</span><span class="op">-</span><span class="st"> </span>binLevelData<span class="op">$</span>cells<span class="op">/</span>binLevelData<span class="op">$</span>totalCells)</span>
<span id="cb4-12"><a href="#cb4-12"></a></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="co">#plot the distribution of reads for each example guide</span></span>
<span id="cb4-14"><a href="#cb4-14"></a>p =<span class="st"> </span><span class="kw">ggplot</span>(binLevelData[binLevelData<span class="op">$</span>gid <span class="op">%in%</span><span class="st"> </span>exampleNT,], <span class="kw">aes</span>(<span class="dt">x=</span>Bin, <span class="dt">group=</span>Bin, <span class="dt">y=</span>reads)) <span class="op">+</span></span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">fill=</span><span class="st">&quot;darkgray&quot;</span>)<span class="op">+</span></span>
<span id="cb4-16"><a href="#cb4-16"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data=</span>binLevelData[binLevelData<span class="op">$</span>gid <span class="op">%in%</span><span class="st"> </span>exampleT,], <span class="kw">aes</span>(<span class="dt">group=</span>gid), <span class="dt">colour=</span><span class="st">&quot;red&quot;</span>)<span class="op">+</span><span class="st">  </span></span>
<span id="cb4-17"><a href="#cb4-17"></a><span class="st">  </span><span class="kw">theme_classic</span>()  <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Expression bin&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Reads/bin&quot;</span>)  <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)); </span>
<span id="cb4-18"><a href="#cb4-18"></a><span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>binReadMat =<span class="st"> </span><span class="kw">cast</span>(binLevelData, element<span class="op">+</span>gid<span class="op">+</span>NT <span class="op">~</span><span class="st"> </span>Bin, <span class="dt">value=</span><span class="st">&quot;reads&quot;</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">#pretend we sequence the unsorted cells to similar coverage as above:</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>guideMap<span class="op">$</span>NS =<span class="st"> </span><span class="kw">rnbinom</span>(<span class="dt">n=</span><span class="kw">nrow</span>(guideMap), <span class="dt">size=</span><span class="kw">sum</span>(guideMap<span class="op">$</span>cells)<span class="op">*</span><span class="dv">10</span>, </span>
<span id="cb5-5"><a href="#cb5-5"></a>  <span class="dt">prob=</span><span class="dv">1</span><span class="op">-</span><span class="st"> </span>guideMap<span class="op">$</span>abundance<span class="op">/</span><span class="kw">sum</span>(guideMap<span class="op">$</span>cells))</span>
<span id="cb5-6"><a href="#cb5-6"></a>binReadMat =<span class="st"> </span><span class="kw">merge</span>(binReadMat, guideMap[<span class="kw">c</span>(<span class="st">&quot;gid&quot;</span>,<span class="st">&quot;NS&quot;</span>)], <span class="dt">by=</span><span class="st">&quot;gid&quot;</span>)</span>
<span id="cb5-7"><a href="#cb5-7"></a></span>
<span id="cb5-8"><a href="#cb5-8"></a>binReadMat<span class="op">$</span>screen=<span class="st">&quot;test&quot;</span>; <span class="co"># here, we&#39;re only doing the one screen - this simulation</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>binBounds<span class="op">$</span>screen=<span class="st">&quot;test&quot;</span>;</span></code></pre></div>
</div>
<div id="run-maude" class="section level2">
<h2>Run MAUDE</h2>
<p>Up until now, we have just been building up the data in a way that simulated an actual experiment. With the exception of defining the bin model(s), most of the above is not required (nor even possible, since we’re inspecting hidden variables above) for an actual experiment. Only the next two commands would actually be run for a real experiment.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># get guide-level stats </span></span>
<span id="cb6-2"><a href="#cb6-2"></a>guideLevelStats =<span class="st"> </span><span class="kw">findGuideHitsAllScreens</span>(<span class="kw">unique</span>(binReadMat[<span class="st">&quot;screen&quot;</span>]), binReadMat, binBounds)</span>
<span id="cb6-3"><a href="#cb6-3"></a></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co">#get element level stats</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>elementLevelStats =<span class="st"> </span><span class="kw">getElementwiseStats</span>(<span class="kw">unique</span>(guideLevelStats[<span class="st">&quot;screen&quot;</span>]),</span>
<span id="cb6-6"><a href="#cb6-6"></a>  guideLevelStats, <span class="dt">elementIDs=</span><span class="st">&quot;element&quot;</span>,<span class="dt">tails=</span><span class="st">&quot;upper&quot;</span>)</span></code></pre></div>
<pre><code>## Building background with 1000 non-targeting guides</code></pre>
<p>Plot the actual effect sizes (those we defined at the begining) compared with those predicted by MAUDE:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>elementLevelStats =<span class="st"> </span><span class="kw">merge</span>(elementLevelStats, groundTruth, <span class="dt">by=</span><span class="st">&quot;element&quot;</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a></span>
<span id="cb8-3"><a href="#cb8-3"></a>p =<span class="st"> </span><span class="kw">ggplot</span>(elementLevelStats, <span class="kw">aes</span>(<span class="dt">x=</span>meanEffect, <span class="dt">y=</span>meanZ, <span class="dt">colour=</span>FDR<span class="op">&lt;</span><span class="fl">0.01</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()<span class="op">+</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="dv">0</span>, <span class="dt">slope=</span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span><span class="kw">scale_colour_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;darkgray&quot;</span>,<span class="st">&quot;red&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;True effect&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Inferred effect&quot;</span>); <span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see that the two are highly correlated. At more extreme effect sizes, MAUDE underestimates the effect size because of the uniform prior applied (in the form of a pseudocount). However, biological data can be very noisy and so we highly recommend this prior.</p>
<p>Zoom in on the bottom left:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>p =<span class="st"> </span><span class="kw">ggplot</span>(elementLevelStats, <span class="kw">aes</span>(<span class="dt">x=</span>meanEffect, <span class="dt">y=</span>meanZ, <span class="dt">colour=</span>FDR<span class="op">&lt;</span><span class="fl">0.01</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()<span class="op">+</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="dv">0</span>, <span class="dt">slope=</span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span><span class="kw">scale_colour_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;darkgray&quot;</span>,<span class="st">&quot;red&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.1</span>),<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;True effect&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Inferred effect&quot;</span>); </span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>In this particular simulation we have 1 false positive out of nearly 100 true positives (consistent with our FDR cutoff of 0.01), and three false negatives with very small effect sizes.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
